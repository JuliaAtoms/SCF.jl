<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fock Operators · SCF</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script src="../assets/latex.js"></script></head><body><nav class="toc"><h1>SCF</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../quantum_systems/">Quantum Systems</a></li><li class="current"><a class="toctext" href>Fock Operators</a><ul class="internal"></ul></li><li><a class="toctext" href="../self_consistent_iteration/">Self-Consistent Iteration</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Fock Operators</a></li></ul><a class="edit-page" href="https://github.com/JuliaAtoms/SCF.jl/blob/master/docs/src/fock_operators.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Fock Operators</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Fock-Operators-1" href="#Fock-Operators-1">Fock Operators</a></h1><p>The Fock operator consists of an <a href="../quantum_systems/#SCF.AbstractQuantumSystem"><code>AbstractQuantumSystem</code></a> and a set of coupled integro-differential equations, the solution of which is the objective of the self-consistent field procedure. For the solution process to work, the set of equations need to implement a few methods:</p><ol><li>It must fulfil Julia&#39;s iteration interface, i.e. each element must be the equation for a single orbital, which is solved independently from the other equations, but with the other orbitals as inputs.</li><li><a href="#SCF.energy"><code>energy</code></a> which calculates the orbital energy, i.e. <span>$\matrixel{\chi}{\Hamiltonian}{\chi}$</span>.</li><li><a href="#SCF.energy_matrix!"><code>energy_matrix!</code></a> which calculates the energy matrix <span>$\mat{H}_i$</span> for orbital equation <span>$i$</span>, where <span>$\vec{c}^H\mat{H}_i\vec{c}$</span> gives the orbital energy for the correspond orbital. The overall energy matrix <span>$\mat{H}=\sum_i\mat{H}_i$</span> is used to solve the secular problem for the mixing coefficients.</li><li><a href="#SCF.update!"><code>update!</code></a> which recomputes all orbital-dependent integrals, shared among the equations of the equation system.</li></ol><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SCF.Fock" href="#SCF.Fock"><code>SCF.Fock</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">Fock(quantum_system, equations)</code></pre><p>A Fock operator consists of a <code>quantum_system</code>, from which <code>equations</code> are variationally derived. <code>equations</code> must be iterable, where each element corresponds to the equation for one orbital, and must provide overloads for the functions <a href="#SCF.energy"><code>energy</code></a>, <a href="#SCF.energy_matrix!"><code>energy_matrix!</code></a>, and <a href="#SCF.hamiltonian"><code>hamiltonian</code></a>.  Additionally, <a href="#SCF.update!"><code>update!</code></a> must be provided for <code>equations</code>, to prepare the equation system for the next iteration.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/SCF.jl/blob/2be023f66500a4415d92142c4340ee8d8ca94bf1/src/fock.jl#L1-L11">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SCF.norm_rot!" href="#SCF.norm_rot!"><code>SCF.norm_rot!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">norm_rot!(fock, v)</code></pre><p>Normalize and rotate the eigenvector <code>v</code> such that the largest lobe has positive sign.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/SCF.jl/blob/2be023f66500a4415d92142c4340ee8d8ca94bf1/src/fock.jl#L105-L110">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SCF.rotate_max_lobe!" href="#SCF.rotate_max_lobe!"><code>SCF.rotate_max_lobe!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">rotate_max_lobe!(v)</code></pre><p>Rotate the vector <code>v</code> such that the largest lobe has positive sign.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/SCF.jl/blob/2be023f66500a4415d92142c4340ee8d8ca94bf1/src/fock.jl#L94-L98">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SCF.energy" href="#SCF.energy"><code>SCF.energy</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">energy(equation::Equation)</code></pre><p>Computes the orbital energy of <code>equation</code>. <em>To be overloaded by the user.</em></p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/SCF.jl/blob/2be023f66500a4415d92142c4340ee8d8ca94bf1/src/fock.jl#L33-L38">source</a><div><div><pre><code class="language-none">energy(fock::Fock)</code></pre><p>Calculates the total energy of the system by summing the orbital energies.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/SCF.jl/blob/2be023f66500a4415d92142c4340ee8d8ca94bf1/src/fock.jl#L41-L45">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SCF.energy_matrix!" href="#SCF.energy_matrix!"><code>SCF.energy_matrix!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">energy_matrix!(H::AbstractMatrix, equation::Equation)</code></pre><p>Assemble the energy matrix for <code>equation</code>, i.e. the matrix where the elements are the energies corresponding to the mixing of configurations, basically the Hamiltonian matrix of the corresponding orbital. This matrix, sandwiched between the mixing coefficients, gives the orbital energy. <em>To be overloaded by the user.</em> NB the matrix elements should be added to, i.e. <em>not overwritten</em>, rather, the overload of <code>energy_matrix!</code> should compute (the equivalent of) <code>H += H_i</code>, where <code>H_i</code> is the energy matrix for <code>equation</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/SCF.jl/blob/2be023f66500a4415d92142c4340ee8d8ca94bf1/src/fock.jl#L48-L59">source</a><div><div><pre><code class="language-none">energy_matrix!(H::AbstractMatrix, fock::Fock)</code></pre><p>Calculates the total energy matrix of the system by summing the energy matrices of the different orbital equations of <code>fock</code>. This overwrites the entries of <code>H</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/SCF.jl/blob/2be023f66500a4415d92142c4340ee8d8ca94bf1/src/fock.jl#L63-L69">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SCF.hamiltonian" href="#SCF.hamiltonian"><code>SCF.hamiltonian</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">hamiltonian(equation::Equation)</code></pre><p>Returns the orbital Hamiltonian of <code>equation</code>. <em>To be overloaded by the user.</em></p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/SCF.jl/blob/2be023f66500a4415d92142c4340ee8d8ca94bf1/src/fock.jl#L76-L81">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SCF.update!" href="#SCF.update!"><code>SCF.update!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">update!(eqs; kwargs...)</code></pre><p>Update the equation system <code>eqs</code> for the current iteration. <em>To be overloaded by the user.</em></p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/SCF.jl/blob/2be023f66500a4415d92142c4340ee8d8ca94bf1/src/fock.jl#L85-L90">source</a></section><footer><hr/><a class="previous" href="../quantum_systems/"><span class="direction">Previous</span><span class="title">Quantum Systems</span></a><a class="next" href="../self_consistent_iteration/"><span class="direction">Next</span><span class="title">Self-Consistent Iteration</span></a></footer></article></body></html>
